Split the local server into a library, separate from a small binary.

Perhaps combine this into one package with diff-toll-logic, with server features
perhaps locked behind a feature flag.